# 行空板M10遇到FireBeetle esp32s3 

## 项目描述
# 基于 M10 行空板的传感器数据采集与实时监控项目

## 一、项目概述
本项目旨在通过 M10 行空板作为核心控制单元，利用 MQTT 协议从远端的 ESP32-S3 设备接入的多种传感器（包括土壤湿度传感器、DFRobot 五合一环境传感器和空气质量传感器）采集数据。采集到的数据将实时渲染为曲线图，直观展示传感器状态信息。当空气质量传感器检测到空气质量变差时，系统会通过连接在 M10 行空板上的语音合成模块播放告警信息，以提醒用户采取相应措施。

## 二、项目组成

### （一）硬件部分
- **M10 行空板**：作为项目的主控设备，负责接收传感器数据、处理数据以及控制语音合成模块播放告警信息。
- **ESP32-S3**：远端设备，连接各类传感器，通过 Wi-Fi 将传感器数据发送至 M10 行空板。
- **传感器**
  - **土壤湿度传感器**：用于检测土壤的湿度情况，适用于农业、园艺等领域，可帮助用户了解植物生长环境。
  - **DFRobot 五合一环境传感器**：可同时测量温度、湿度、气压、光照强度和紫外线强度等多种环境参数，为用户提供全面的环境信息。
  - **空气质量传感器**：用于监测空气质量，当检测到空气质量变差时，触发语音告警功能。
- **语音合成模块**：连接在 M10 行空板上，用于播放告警信息，提醒用户空气质量问题。

### （二）软件部分
- **MQTT 协议**：用于实现 ESP32-S3 与 M10 行空板之间的数据通信。ESP32-S3 作为客户端，将采集到的传感器数据通过 MQTT 协议发送到 M10 行空板。
- **数据处理与可视化**：M10 行空板接收到数据后，对数据进行处理，并通过实时渲染曲线图的方式直观展示传感器状态信息。曲线图能够清晰地反映各传感器数据随时间的变化趋势，方便用户快速了解当前环境状况。
- **语音告警功能**：当空气质量传感器检测到空气质量变差时，M10 行空板触发语音合成模块播放预设的告警信息，提醒用户采取相应措施，如通风换气等。

## 三、项目实现原理

### （一）数据采集
1. ESP32-S3 设备连接土壤湿度传感器、DFRobot 五合一环境传感器和空气质量传感器，定期采集各传感器的数据。
2. ESP32-S3 通过 Wi-Fi 连接到网络，并作为 MQTT 客户端，将采集到的传感器数据封装成 MQTT 消息，发送到指定的 MQTT 服务器（M10 行空板作为服务器或通过中间 MQTT 代理服务器转发）。

### （二）数据传输与接收
1. M10 行空板运行 MQTT 客户端程序，订阅 ESP32-S3 发送的传感器数据主题。
2. 当 M10 行空板接收到 MQTT 消息时，解析消息内容，提取传感器数据。

### （三）数据处理与可视化
1. M10 行空板对接收到的传感器数据进行处理，存储数据并更新数据缓冲区。
2. 使用图形库（如 uGUI 等）实时渲染曲线图，将传感器数据以曲线形式展示在显示屏上。曲线图的横轴表示时间，纵轴表示传感器数据的数值，通过动态更新曲线图，用户可以直观地看到各传感器数据的变化趋势。

### （四）语音告警功能
1. M10 行空板实时监测空气质量传感器的数据，当检测到空气质量低于预设阈值时，触发语音告警功能。
2. M10 行空板控制连接的语音合成模块播放预设的告警语音信息，提醒用户空气质量变差，需要采取相应措施。

## 四、项目优势
- **实时性**：通过 MQTT 协议快速传输数据，确保传感器数据能够实时更新并展示在曲线图上，让用户能够及时了解环境变化。
- **直观性**：采用曲线图的方式展示传感器数据，直观易懂，方便用户快速判断当前环境状况。
- **告警功能**：当空气质量变差时，语音告警功能能够及时提醒用户，增强项目的实用性和安全性。
- **扩展性**：基于 MQTT 协议和 M10 行空板的架构，可以方便地扩展接入更多的传感器或增加其他功能模块，满足不同场景的需求。

## 五、项目应用场景
本项目适用于多种场景，如智能家居环境监测、农业温室环境监控、小型气象站等。通过实时监测环境参数并及时告警，为用户提供便捷的环境管理解决方案，帮助用户更好地了解和管理所处环境。

## 六、设备说明
* 开发环境：
树莓派5 + arduino-cli + esp32s3 + Multifunctional Environmental sensor v2.0 

ESP32代码在esp32_weather
M10代码在M10-python-code 

## 七、M10 上传代码方法
1. 连接m10到usb等待启动。
2. 通过mobaXterm开远程连接到10.1.2.3
```bash 
ssh root@10.1.2.3 
```
密码默认：dfrobot
3. 切换目录到 /opt/unihiker/examples/ 
创建一个你的项目目录:
```bash 
mkdir 12-yoyojacky
cd 12-yoyojacky
```
4. 把仓库中m10的代码拷贝进去，根据你实际情况修改ip地址和端口号信息即可。
也可以根据实际情况更改代码的内容适配你实际环境。

## PS
整个操作通过arduino-cli 编译和上传，具体请参考`arduino-cli` 相关主题的内容。
